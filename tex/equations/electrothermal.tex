\section{Electro-Thermal}
From (\ref{eq:faraday}), in steady case, we know that there exist a scalar
potential $V$ such that $\bE = -\nabla V$.\\
Furthermore, the Ohm's law tells us that the current density $\bj$ is
proportional to the electric field $\bE$:
\begin{equation*}
  \bj = \sigma\bE
\end{equation*}
where $\sigma$ is the electrical conductivity of the material.\\
Finally, the charge conservation principle
\begin{equation*}
  \frac{\partial\rho}{\partial t} + \nabla\cdot\bj = 0
\end{equation*}
where $\rho$ is the charge density, gives, in the steady case, the equation:
\begin{equation}
  \nabla\cdot(-\sigma\nabla V) = 0
\end{equation}

The heat variation can be obtain in two ways:
\begin{equation*}
  \delta Q = C_p\rho_Q\frac{\partial T}{\partial t}
\end{equation*}
where $C_p$ and $\rho_Q$ are respectively the specific heat capacity and the
mass density of the material.\\
It can also reads from the heat flux density $\bj_Q$ and the eventual internal
sources of heat $P$
\begin{equation*}
  \delta Q = \nabla\cdot\bj_Q + P
\end{equation*}
The Fourier's law defines $\bj_Q$ as $-k\nabla T$ where $k$ is the thermal
conductivity of the material. The internal source of heat is the Joule effect,
we then have $P=\bj\cdot\bE=\sigma\nabla V\cdot\nabla V$.\\
In the steady case, this gives us:
\begin{equation}
  \nabla\cdot(k\nabla T) = \sigma\nabla V\cdot\nabla V
\end{equation}

The electrical and thermal conductivity of the materials depend both on the
temperature. This leads to a non-linearity in the coupled electro-thermal model.

The current circulation is imposed as a difference of potential $V_D$ between
current input and output:
\begin{itemize}
\item
  $V=0$ on $\Gamma_{V_{in}}$
\item
  $V=V_D$ on $\Gamma_{V_{out}}$
\end{itemize}
The air and the cooling water surrounding the magnet are considered as
electrically insulating:
\begin{itemize}
\item
  $-\sigma(T)\nabla V\cdot\bn = 0$
  on $\partial\Omega\setminus(\Gamma_{V_{in}}\cup\Gamma_{V_{out}})$
\end{itemize}
The thermal flux $\bj_Q\cdot\bn$ is non-zero only on the cooled surfaces
$\Gamma_c$. The thermal exchange between the conductor and the cooling water is
governed by a convection phenomenon. The amount of heat exchanged depends on a
heat tranfer coefficient $h$ and defines the thermal flux on cooled regions as
$\bj_{Q} \cdot \mathbf{n} = h(T - T_0)$. The heat transfer coefficient is
determined from the thermal conductivity $k(T)$, the hydraulic diameter $D_h$
and the Nusselt number $Nu$ commonly used in heat transfer considerations.
\begin{equation}
  h = \frac{k(T) Nu}{D_h}
\end{equation}
This gives:
\begin{itemize}
\item
  $-k(T)\nabla T\cdot\bn = h(T-T_0)$ on $\Gamma_c$
\item
  $-k(T)\nabla T\cdot\bn = 0$ on $\partial\Omega\setminus\Gamma_c$
\end{itemize}

Then, the equations to solve are:
\begin{empheq}[left=\empheqlbrace]{alignat=2}
  \nabla\cdot(-\sigma(T)\nabla V) &= 0 && \quad \text{ in } \Omega \\
  \nabla\cdot(k(T)\nabla T) &= \sigma(T)\nabla V \cdot \nabla V
  && \quad \text{ in } \Omega \\
  V &= 0 && \quad \text{ on } \Gamma_{V_{in}} \\
  v &= V_D && \quad \text{ on } \Gamma_{V_{out}} \\
  -\sigma(T)\nabla V\cdot\bn &= 0 && \quad \text{ on }
  \partial\Omega\setminus(\Gamma_{V_{in}}\cup\Gamma_{V_{out}}) \\
  -k(T)\nabla T\cdot\bn &= h(T-T_0) && \quad \text{ on } \Gamma_c \\
  -k(T)\nabla T\cdot\bn &= 0 && \quad\text{ on } \partial\Omega\setminus\Gamma_c
\end{empheq}

\subsection{Variational formulation}
\subsubsection{Standard formulation}
\subsubsection{Hybrid formulation}

\subsection{Resolution strategy}
The current is imposed by a difference of potential, but it would be more
consistent with the experiment to give a current density as a target and
update the Dirichlet boundary conditions to approach the current.\\
In the following, this option is
\subsubsection{Linear}
\algsetup{indent=2em}
\begin{algorithm}[H]
  \caption{Linear Resolution}
  \label{algo:et-linear}
  \begin{algorithmic}
    \REQUIRE $T^0$, $V^0$, $\varepsilon_I$, $N_{max}$
    \ENSURE $I$
    \STATE $e_I=0$
    \STATE $V_0=V^0$
    \STATE $i=0$
    \vspace{0.3cm}
    \REPEAT
      \STATE $V_{i+1} =$ \textbf{solveV}($V_i,T^0$)
      \IF{$I$}
        \STATE $e_I =$ \textbf{updateBC}($V_{i+1},I$)
      \ENDIF
      \STATE $i = i+1$
    \UNTIL{$e_I < \varepsilon_I$ \OR $i\geq N_{max}$}
    \STATE $V=V_i$
    \STATE $T =$ \textbf{solveT}($V,T^0$)
    \RETURN $(V,T)$
  \end{algorithmic}
\end{algorithm}

\subsubsection{Picard}
\algsetup{indent=2em}
\begin{algorithm}[H]
  \caption{Non-Linear Resolution using Picard}
  \label{algo:et-picard}
  \begin{algorithmic}
    \REQUIRE $T^0$, $V^0$, $\varepsilon_I$, $\varepsilon_V$, $\varepsilon_T$,
    $N_{max}$
    \ENSURE $I$
    \STATE $e_I=0, e_V=\infty, e_T=\infty$
    \STATE $V=V^0,T=T^0$
    \STATE $j=0$
    \vspace{0.3cm}
    \REPEAT
      \STATE $i=0$
      \STATE $V_i=V,T_i=T$
      \REPEAT
        \STATE $V_{i+1} =$ \textbf{solveV}($V_i,T$)
        \STATE $e_V = \parallel V_{i+1}-V_i\parallel / \parallel V_i\parallel$
        \IF{$I$}
          \STATE $e_I =$ \textbf{updateBC}($V_{i+1},I$)
        \ENDIF
        \STATE $i = i+1$
      \UNTIL{($e_I < \varepsilon_I$ \AND $e_V < \varepsilon_V$)
        \OR $i\geq N_{max}$}
      \STATE $V=V_i$
      \STATE $i=0$
      \REPEAT
        \STATE $T_{i+1} =$ \textbf{solveT}($V,T_i$)
        \STATE $e_T = \parallel T_{i+1}-T_i\parallel / \parallel T_i\parallel$
        \STATE $i=i+1$
      \UNTIL{$e_T < \varepsilon_T$ \OR $i\geq N_{max}$}
      \STATE $T=T_i$
      \STATE $j=j+1$
      \UNTIL{($e_V < \varepsilon_V$ \AND $e_T < \varepsilon_T$)
        \OR $j\geq N_{max}$}
    \RETURN $(V,T)$
  \end{algorithmic}
\end{algorithm}

\subsubsection{Newton}
\algsetup{indent=2em}
\begin{algorithm}[H]
  \caption{Non-Linear Resolution using Newton}
  \label{algo:et-newton}
  \begin{algorithmic}
    \REQUIRE $T^0$, $V^0$, $\varepsilon_I$, $\varepsilon_V$, $\varepsilon_T$,
    $N_{max}$
    \ENSURE $I$
    \STATE $e_I=0$
    \STATE $V_0=V^0$
    \STATE $i=0$
    \vspace{0.3cm}
    \REPEAT
      \STATE $V_{i+1} =$ \textbf{solveV}($V_i,T$)
      \IF{$I$}
        \STATE $e_I =$ \textbf{updateBC}($V_{i+1},I$)
      \ENDIF
      \STATE $i=i+1$
    \UNTIL{$e_I < \varepsilon_I$ \OR $i\geq N_{Max}$}
    \STATE $V=V_i$
    \STATE $T =$ \textbf{solveT}($V,T^0$)
    \STATE $i=0$
    \REPEAT
    \STATE \textbf{solveNewton}($V,T,\varepsilon_V,\varepsilon_T$)
      \IF{$I$}
        \STATE $e_I =$ \textbf{updateBC}($V_{i+1},I$)
      \ENDIF
      \STATE $i=i+1$
    \UNTIL{$e_I < \varepsilon_I$ \OR $i\geq N_{max}$}
    \RETURN $(V,T)$
  \end{algorithmic}
\end{algorithm}
